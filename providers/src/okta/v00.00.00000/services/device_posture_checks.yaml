openapi: 3.0.3
info:
  title: device_posture_checks API
  description: okta device_posture_checks API
  version: 5.1.0
paths:
  /api/v1/device-posture-checks:
    get:
      summary: List all device posture checks
      description: Lists all device posture checks
      operationId: listDevicePostureChecks
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/DevicePostureCheck'
        '403':
          $ref: '#/components/responses/ErrorAccessDenied403'
        '429':
          $ref: '#/components/responses/ErrorTooManyRequests429'
      security:
        - apiToken: []
        - oauth2:
            - okta.devicePostureChecks.read
      tags:
        - DevicePostureCheck
      x-okta-lifecycle:
        lifecycle: EA
        isGenerallyAvailable: false
        SKUs:
          - Okta Identity Engine
    post:
      x-okta-lifecycle:
        lifecycle: GA
        isGenerallyAvailable: false
        SKUs: []
      summary: Create a device posture check
      description: Creates a device posture check
      operationId: createDevicePostureCheck
      x-codegen-request-body-name: devicePostureCheck
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/DevicePostureCheck'
            examples:
              MacOS:
                $ref: '#/components/examples/DevicePostureChecksMacOSRequest'
              Windows:
                $ref: '#/components/examples/DevicePostureChecksWindowsRequest'
        required: true
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/DevicePostureCheck'
              examples:
                MacOS:
                  $ref: '#/components/examples/DevicePostureChecksMacOSResponse'
                Windows:
                  $ref: '#/components/examples/DevicePostureChecksWindowsResponse'
        '400':
          $ref: '#/components/responses/ErrorApiValidationFailed400'
        '403':
          $ref: '#/components/responses/ErrorAccessDenied403'
        '429':
          $ref: '#/components/responses/ErrorTooManyRequests429'
      security:
        - apiToken: []
        - oauth2:
            - okta.devicePostureChecks.manage
      tags:
        - DevicePostureCheck
  /api/v1/device-posture-checks/default:
    get:
      x-okta-lifecycle:
        lifecycle: GA
        isGenerallyAvailable: false
        SKUs: []
      summary: List all default device posture checks
      description: >-
        Lists all default device posture checks. Default device posture checks
        are defined by Okta. Their type will always be `BUILTIN`.
      operationId: listDefaultDevicePostureChecks
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/DevicePostureCheck'
        '403':
          $ref: '#/components/responses/ErrorAccessDenied403'
        '429':
          $ref: '#/components/responses/ErrorTooManyRequests429'
      security:
        - apiToken: []
        - oauth2:
            - okta.devicePostureChecks.read
      tags:
        - DevicePostureCheck
  /api/v1/device-posture-checks/{postureCheckId}:
    get:
      summary: Retrieve a device posture check
      description: Retrieves a device posture check by `postureCheckId`
      operationId: getDevicePostureCheck
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/DevicePostureCheck'
              examples:
                MacOS:
                  $ref: '#/components/examples/DevicePostureChecksMacOSResponse'
                Windows:
                  $ref: '#/components/examples/DevicePostureChecksWindowsResponse'
        '403':
          $ref: '#/components/responses/ErrorAccessDenied403'
        '404':
          $ref: '#/components/responses/ErrorResourceNotFound404'
        '429':
          $ref: '#/components/responses/ErrorTooManyRequests429'
      security:
        - apiToken: []
        - oauth2:
            - okta.devicePostureChecks.read
      tags:
        - DevicePostureCheck
      x-okta-lifecycle:
        lifecycle: EA
        isGenerallyAvailable: false
        SKUs:
          - Okta Identity Engine
    put:
      x-okta-lifecycle:
        lifecycle: GA
        isGenerallyAvailable: false
        SKUs: []
      summary: Replace a device posture check
      description: Replaces a device posture check by `postureCheckId`
      operationId: replaceDevicePostureCheck
      x-codegen-request-body-name: devicePostureCheck
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/DevicePostureCheck'
            examples:
              MacOS:
                $ref: '#/components/examples/DevicePostureChecksMacOSRequest'
              Windows:
                $ref: '#/components/examples/DevicePostureChecksWindowsRequest'
        required: true
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/DevicePostureCheck'
              examples:
                MacOS:
                  $ref: '#/components/examples/DevicePostureChecksMacOSResponse'
                Windows:
                  $ref: '#/components/examples/DevicePostureChecksWindowsResponse'
        '400':
          $ref: '#/components/responses/ErrorApiValidationFailed400'
        '403':
          $ref: '#/components/responses/ErrorAccessDenied403'
        '404':
          $ref: '#/components/responses/ErrorResourceNotFound404'
        '429':
          $ref: '#/components/responses/ErrorTooManyRequests429'
      security:
        - apiToken: []
        - oauth2:
            - okta.devicePostureChecks.manage
      tags:
        - DevicePostureCheck
    delete:
      summary: Delete a device posture check
      description: >-
        Deletes a device posture check by `postureCheckId`. You can't delete the
        device posture check if it's used in a device assurance policy.
      operationId: deleteDevicePostureCheck
      responses:
        '204':
          description: No Content
        '403':
          $ref: '#/components/responses/ErrorAccessDenied403'
        '404':
          $ref: '#/components/responses/ErrorResourceNotFound404'
        '409':
          description: Conflict
          headers: {}
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
              examples:
                ErrorDeviceCheckInUse:
                  $ref: '#/components/examples/ErrorDevicePostureCheckInUse'
        '429':
          $ref: '#/components/responses/ErrorTooManyRequests429'
      security:
        - apiToken: []
        - oauth2:
            - okta.devicePostureChecks.manage
      tags:
        - DevicePostureCheck
      x-okta-lifecycle:
        lifecycle: EA
        isGenerallyAvailable: false
        SKUs:
          - Okta Identity Engine
    parameters:
      - $ref: '#/components/parameters/pathPostureCheckId'
components:
  schemas:
    DevicePostureCheck:
      title: DevicePostureCheck
      type: object
      properties:
        createdBy:
          type: string
          readOnly: true
          description: User who created the device posture check
          example: 00u217pyf72CdUrBt1c5
        createdDate:
          type: string
          readOnly: true
          description: Time the device posture check was created
          example: '2019-10-02T18:03:07.000Z'
        description:
          type: string
          description: Description of the device posture check
          example: Query macOS devices to check if firewall is enabled
        id:
          type: string
          readOnly: true
          description: The ID of the device posture check
          example: dch3m8o4rWhwReDeM1c5
        lastUpdate:
          type: string
          readOnly: true
          description: Time the device posture check was updated
          example: '2019-10-02T18:03:07.000Z'
        lastUpdatedBy:
          type: string
          readOnly: true
          description: User who updated the device posture check
          example: 00u217pyf72CdUrBt1c5
        mappingType:
          $ref: '#/components/schemas/DevicePostureChecksMappingType'
        name:
          type: string
          description: Display name of the device posture check
          example: Device posture check macOS
        platform:
          $ref: '#/components/schemas/DevicePostureChecksPlatform'
        query:
          type: string
          description: OSQuery for the device posture check
          example: >-
            SELECT CASE WHEN global_state = 0 THEN 0 ELSE 1 END AS
            firewall_enabled FROM  alf;
        remediationSettings:
          $ref: '#/components/schemas/DevicePostureChecksRemediationSettings'
        type:
          $ref: '#/components/schemas/DevicePostureChecksType'
        variableName:
          type: string
          description: Unique name of the device posture check
          example: macOSFirewall
        _links:
          $ref: '#/components/schemas/LinksSelf'
    Error:
      title: Error
      type: object
      properties:
        errorCauses:
          type: array
          items:
            $ref: '#/components/schemas/ErrorCause'
        errorCode:
          type: string
          description: An Okta code for this type of error
        errorId:
          type: string
          description: >-
            A unique identifier for this error. This can be used by Okta Support
            to help with troubleshooting.
        errorLink:
          type: string
          description: An Okta code for this type of error
        errorSummary:
          type: string
          description: >-
            A short description of what caused this error. Sometimes this
            contains dynamically-generated information about your specific
            error.
    DevicePostureChecksMappingType:
      description: >-
        Represents how the device posture check is rendered in device assurance
        policies
      type: string
      enum:
        - CHECKBOX
        - TEXTBOX
    DevicePostureChecksPlatform:
      type: string
      enum:
        - MACOS
        - WINDOWS
    DevicePostureChecksRemediationSettings:
      description: >-
        Represents the remediation instructions shown to the end user when the
        device posture check fails
      type: object
      properties:
        link:
          type: object
          properties:
            defaultUrl:
              type: string
              description: >-
                Default URL for the link. This property is only relevant if type
                is set to `BUILTIN`. If type is set to `CUSTOM`, this field is
                ignored.
              example: >-
                https://help.okta.com/eu/en-us/content/topics/end-user/ov-device-health-macos.htm
            customUrl:
              type: string
              description: Custom URL for the link
              example: example.myremediationurl.com/docs
        message:
          type: object
          properties:
            defaultI18nKey:
              type: string
              description: >-
                Default i18n key for the message. This property is only relevant
                if type is set to `BUILTIN`. If type is set to `CUSTOM`, this
                field is ignored.
              example: macos.firewall.enabled.remediation.message
            customText:
              type: string
              description: Custom text for the message
              example: >-
                It is our company policy that all devices must have a firewall
                enabled.
    DevicePostureChecksType:
      type: string
      enum:
        - BUILTIN
        - CUSTOM
    LinksSelf:
      description: >-
        Specifies link relations (see [Web
        Linking](https://www.rfc-editor.org/rfc/rfc8288)) available using the
        [JSON Hypertext Application
        Language](https://datatracker.ietf.org/doc/html/draft-kelly-json-hal-06)
        specification. This object is used for dynamic discovery of related
        resources and lifecycle operations.
      type: object
      properties:
        self:
          $ref: '#/components/schemas/HrefObjectSelfLink'
      readOnly: true
    ErrorCause:
      type: object
      properties:
        errorSummary:
          type: string
    HrefObjectSelfLink:
      allOf:
        - $ref: '#/components/schemas/HrefObject'
        - description: Link to the resource (self)
    HrefObject:
      title: Link Object
      additionalProperties: true
      type: object
      properties:
        hints:
          $ref: '#/components/schemas/HrefHints'
          readOnly: true
        href:
          type: string
          description: Link URI
        name:
          type: string
          description: Link name
          readOnly: true
        templated:
          type: boolean
          description: >-
            Indicates whether the link object's `href` property is a URI
            template.
          readOnly: true
        type:
          type: string
          description: >-
            The media type of the link. If omitted, it is implicitly
            `application/json`.
          readOnly: true
      required:
        - href
    HrefHints:
      description: Describes allowed HTTP verbs for the `href`
      type: object
      properties:
        allow:
          type: array
          items:
            $ref: '#/components/schemas/HttpMethod'
    HttpMethod:
      type: string
      enum:
        - DELETE
        - GET
        - POST
        - PUT
  responses:
    ErrorAccessDenied403:
      description: Forbidden
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/Error'
          examples:
            AccessDenied:
              $ref: '#/components/examples/ErrorAccessDenied'
    ErrorTooManyRequests429:
      description: Too Many Requests
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/Error'
          examples:
            TooManyRequests:
              $ref: '#/components/examples/ErrorTooManyRequests'
    ErrorApiValidationFailed400:
      description: Bad Request
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/Error'
          examples:
            APIValidationFailed:
              $ref: '#/components/examples/ErrorApiValidationFailed'
    ErrorResourceNotFound404:
      description: Not Found
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/Error'
          examples:
            ResourceNotFound:
              $ref: '#/components/examples/ErrorResourceNotFound'
  parameters:
    pathPostureCheckId:
      in: path
      name: postureCheckId
      required: true
      description: ID of the device posture check
      schema:
        type: string
  examples:
    DevicePostureChecksMacOSRequest:
      summary: macOS request
      value:
        name: Device posture check macOS
        description: Query macOS devices to check if firewall is enabled
        variableName: macOSFirewall
        platform: MACOS
        type: CUSTOM
        mappingType: CHECKBOX
        query: >-
          SELECT CASE WHEN global_state = 0 THEN 0 ELSE 1 END AS
          firewall_enabled FROM alf;
        remediationSettings:
          message:
            defaultI18nKey: null
            customText: >-
              It is our company policy that all devices must have a firewall
              enabled.
          link:
            defaultUrl: null
            customUrl: example.myremediationurl.com/docs
    DevicePostureChecksWindowsRequest:
      summary: Windows request
      value:
        name: Device posture check Windows
        description: Query Windows devices to check if firewall is enabled
        variableName: windowsFirewall
        platform: WINDOWS
        type: CUSTOM
        mappingType: CHECKBOX
        query: >-
          SELECT CASE WHEN enabled = 1 THEN 1 ELSE 0 END AS firewall_enabled
          FROM windows_firewall_profiles;
        remediationSettings:
          message:
            defaultI18nKey: null
            customText: >-
              It is our company policy that all devices must have a firewall
              enabled.
          link:
            defaultUrl: null
            customUrl: example.myremediationurl.com/docs
    DevicePostureChecksMacOSResponse:
      summary: macOS response
      value:
        id: dch3m8o4rWhwReDeM1c5
        name: Device posture check macOS
        lastUpdate: '2022-01-01T00:00:00.000Z'
        createdUpdate: '2022-01-01T00:00:00.000Z'
        lastUpdatedBy: 00u217pyf72CdUrBt1c5
        createdBy: 00u217pyf72CdUrBt1c5
        description: Query macOS devices to check if firewall is enabled
        variableName: macOSFirewall
        query: >-
          SELECT CASE WHEN global_state = 0 THEN 0 ELSE 1 END AS
          firewall_enabled FROM  alf;
        platform: MACOS
        type: CUSTOM
        mappingType: CHECKBOX
        remediationSettings:
          message:
            defaultI18nKey: null
            customText: >-
              It is our company policy that all devices must have a firewall
              enabled.
          link:
            defaultUrl: null
            customUrl: example.myremediationurl.com/docs
        _links:
          self:
            href: >-
              https://your-subdomain.okta.com/api/v1/device-posture-checks/dch3m8o4rWhwReDeM1c5
            hints:
              allow:
                - DELETE
                - GET
                - PUT
    DevicePostureChecksWindowsResponse:
      summary: Windows response
      value:
        id: dch3m8o4rWhwReDeM1c5
        name: Device posture check Windows
        lastUpdate: '2022-01-01T00:00:00.000Z'
        createdUpdate: '2022-01-01T00:00:00.000Z'
        lastUpdatedBy: 00u217pyf72CdUrBt1c5
        createdBy: 00u217pyf72CdUrBt1c5
        description: Query Windows devices to check if firewall is enabled
        variableName: windowsFirewall
        query: >-
          SELECT CASE WHEN enabled = 1 THEN 1 ELSE 0 END AS firewall_enabled
          FROM windows_firewall_profiles;
        platform: WINDOWS
        type: CUSTOM
        mappingType: CHECKBOX
        remediationSettings:
          message:
            defaultI18nKey: null
            customText: >-
              It is our company policy that all devices must have a firewall
              enabled.
          link:
            defaultUrl: null
            customUrl: example.myremediationurl.com/docs
        _links:
          self:
            href: >-
              https://your-subdomain.okta.com/api/v1/device-posture-checks/dch3m8o4rWhwReDeM1c5
            hints:
              allow:
                - DELETE
                - GET
                - PUT
    ErrorDevicePostureCheckInUse:
      summary: Can't delete device posture check in use by device assurance policies
      value:
        errorSummary: Device posture check is in use and can't be deleted.
        errorId: oaenwA1ra80S9W-pvbh4m6haA
        errorCauses: []
    ErrorAccessDenied:
      summary: Access Denied
      value:
        errorCode: E0000006
        errorSummary: You do not have permission to perform the requested action
        errorLink: E0000006
        errorId: sampleNUSD_8fdkFd8fs8SDBK
        errorCauses: []
    ErrorTooManyRequests:
      summary: Too Many Requests
      value:
        errorCode: E0000047
        errorSummary: API call exceeded rate limit due to too many requests.
        errorLink: E0000047
        errorId: sampleQPivGUj_ND5v78vbYWW
        errorCauses: []
    ErrorApiValidationFailed:
      summary: API Validation Failed
      value:
        errorCode: E0000001
        errorSummary: 'Api validation failed: {0}'
        errorLink: E0000001
        errorId: sampleiCF-8D5rLW6myqiPItW
        errorCauses: []
    ErrorResourceNotFound:
      summary: Resource Not Found
      value:
        errorCode: E0000007
        errorSummary: 'Not found: {0}'
        errorLink: E0000007
        errorId: sampleMlLvGUj_YD5v16vkYWY
        errorCauses: []
  x-stackQL-resources:
    device_posture_checks:
      id: okta.device_posture_checks.device_posture_checks
      name: device_posture_checks
      title: Device Posture Checks
      methods:
        list_device_posture_checks:
          operation:
            $ref: '#/paths/~1api~1v1~1device-posture-checks/get'
          response:
            mediaType: application/json
            openAPIDocKey: '200'
        create_device_posture_check:
          operation:
            $ref: '#/paths/~1api~1v1~1device-posture-checks/post'
          response:
            mediaType: application/json
            openAPIDocKey: '200'
        get_device_posture_check:
          operation:
            $ref: '#/paths/~1api~1v1~1device-posture-checks~1{postureCheckId}/get'
          response:
            mediaType: application/json
            openAPIDocKey: '200'
        replace_device_posture_check:
          operation:
            $ref: '#/paths/~1api~1v1~1device-posture-checks~1{postureCheckId}/put'
          response:
            mediaType: application/json
            openAPIDocKey: '200'
        delete_device_posture_check:
          operation:
            $ref: '#/paths/~1api~1v1~1device-posture-checks~1{postureCheckId}/delete'
          response:
            mediaType: ''
            openAPIDocKey: '204'
      sqlVerbs:
        select:
          - $ref: >-
              #/components/x-stackQL-resources/device_posture_checks/methods/list_device_posture_checks
          - $ref: >-
              #/components/x-stackQL-resources/device_posture_checks/methods/get_device_posture_check
        insert:
          - $ref: >-
              #/components/x-stackQL-resources/device_posture_checks/methods/create_device_posture_check
        update: []
        delete:
          - $ref: >-
              #/components/x-stackQL-resources/device_posture_checks/methods/delete_device_posture_check
        replace:
          - $ref: >-
              #/components/x-stackQL-resources/device_posture_checks/methods/replace_device_posture_check
    default_device_posture_checks:
      id: okta.device_posture_checks.default_device_posture_checks
      name: default_device_posture_checks
      title: Default Device Posture Checks
      methods:
        list_default_device_posture_checks:
          operation:
            $ref: '#/paths/~1api~1v1~1device-posture-checks~1default/get'
          response:
            mediaType: application/json
            openAPIDocKey: '200'
      sqlVerbs:
        select:
          - $ref: >-
              #/components/x-stackQL-resources/default_device_posture_checks/methods/list_default_device_posture_checks
        insert: []
        update: []
        delete: []
        replace: []
servers:
  - url: https://{subdomain}.okta.com/
    variables:
      subdomain:
        default: my-org
        description: >-
          The domain of your organization. This can be a provided subdomain of
          an official okta domain (okta.com, oktapreview.com, etc) or one of
          your configured custom domains.
