openapi: 3.0.0
info:
  title: billing API
  description: digitalocean API
  version: '2.0'
paths:
  /v2/customers/my/balance:
    get:
      operationId: balance_get
      summary: Get Customer Balance
      description: >-
        To retrieve the balances on a customer's account, send a GET request to
        `/v2/customers/my/balance`.
      tags:
        - Billing
      responses:
        '200':
          $ref: '#/components/responses/balance'
        '401':
          $ref: '#/components/responses/unauthorized'
        '404':
          $ref: '#/components/responses/not_found'
        '429':
          $ref: '#/components/responses/too_many_requests'
        '500':
          $ref: '#/components/responses/server_error'
        default:
          $ref: '#/components/responses/unexpected_error'
      x-codeSamples:
        - lang: cURL
          source: |-
            curl -X GET \
              -H "Content-Type: application/json" \
              -H "Authorization: Bearer $DIGITALOCEAN_TOKEN" \
              "https://api.digitalocean.com/v2/customers/my/balance"
        - lang: Python
          source: |-
            import os
            from pydo import Client

            client = Client(token=os.environ.get("DIGITALOCEAN_TOKEN"))

            balance = client.balance.get()
      security:
        - bearer_auth:
            - billing:read
  /v2/customers/my/billing_history:
    get:
      operationId: billingHistory_list
      summary: List Billing History
      description: >-
        To retrieve a list of all billing history entries, send a GET request to
        `/v2/customers/my/billing_history`.
      tags:
        - Billing
      responses:
        '200':
          $ref: '#/components/responses/billing_history'
        '401':
          $ref: '#/components/responses/unauthorized'
        '404':
          $ref: '#/components/responses/not_found'
        '429':
          $ref: '#/components/responses/too_many_requests'
        '500':
          $ref: '#/components/responses/server_error'
        default:
          $ref: '#/components/responses/unexpected_error'
      x-codeSamples:
        - lang: cURL
          source: |-
            curl -X GET \
              -H "Content-Type: application/json" \
              -H "Authorization: Bearer $DIGITALOCEAN_TOKEN" \
              "https://api.digitalocean.com/v2/customers/my/billing_history"
        - lang: Python
          source: |-
            import os
            from pydo import Client

            client = Client(token=os.environ.get("DIGITALOCEAN_TOKEN"))

            balance = client.billing_history.list()
      security:
        - bearer_auth:
            - billing:read
  /v2/customers/my/invoices:
    get:
      operationId: invoices_list
      summary: List All Invoices
      description: >-
        To retrieve a list of all invoices, send a GET request to
        `/v2/customers/my/invoices`.
      tags:
        - Billing
      parameters:
        - $ref: '#/components/parameters/per_page'
        - $ref: '#/components/parameters/page'
      responses:
        '200':
          $ref: '#/components/responses/invoices'
        '401':
          $ref: '#/components/responses/unauthorized'
        '429':
          $ref: '#/components/responses/too_many_requests'
        '500':
          $ref: '#/components/responses/server_error'
        default:
          $ref: '#/components/responses/unexpected_error'
      x-codeSamples:
        - lang: cURL
          source: |-
            curl -X GET \
              -H "Content-Type: application/json" \
              -H "Authorization: Bearer $DIGITALOCEAN_TOKEN" \
              "https://api.digitalocean.com/v2/customers/my/invoices"
        - lang: Python
          source: |-
            import os
            from pydo import Client

            client = Client(token=os.environ.get("DIGITALOCEAN_TOKEN"))

            balance = client.invoices.list()
      security:
        - bearer_auth:
            - billing:read
  /v2/customers/my/invoices/{invoice_uuid}:
    get:
      operationId: invoices_get_byUUID
      summary: Retrieve an Invoice by UUID
      description: >-
        To retrieve the invoice items for an invoice, send a GET request to
        `/v2/customers/my/invoices/$INVOICE_UUID`.
      tags:
        - Billing
      parameters:
        - $ref: '#/components/parameters/invoice_uuid'
        - $ref: '#/components/parameters/per_page'
        - $ref: '#/components/parameters/page'
      responses:
        '200':
          $ref: '#/components/responses/invoice'
        '401':
          $ref: '#/components/responses/unauthorized'
        '404':
          $ref: '#/components/responses/not_found'
        '429':
          $ref: '#/components/responses/too_many_requests'
        '500':
          $ref: '#/components/responses/server_error'
        default:
          $ref: '#/components/responses/unexpected_error'
      x-codeSamples:
        - lang: cURL
          source: |-
            curl -X GET \
              -H "Content-Type: application/json" \
              -H "Authorization: Bearer $DIGITALOCEAN_TOKEN" \
              "https://api.digitalocean.com/v2/customers/my/invoices/22737513-0ea7-4206-8ceb-98a575af7681"
        - lang: Python
          source: |-
            import os
            from pydo import Client

            client = Client(token=os.environ.get("DIGITALOCEAN_TOKEN"))

            invoices = client.invoices.get_by_uuid(invoice_uuid=1)
      security:
        - bearer_auth:
            - billing:read
  /v2/customers/my/invoices/{invoice_uuid}/csv:
    get:
      operationId: invoices_get_csvByUUID
      summary: Retrieve an Invoice CSV by UUID
      description: >-
        To retrieve a CSV for an invoice, send a GET request to
        `/v2/customers/my/invoices/$INVOICE_UUID/csv`.
      tags:
        - Billing
      parameters:
        - $ref: '#/components/parameters/invoice_uuid'
      responses:
        '200':
          $ref: '#/components/responses/invoice_csv'
        '401':
          $ref: '#/components/responses/unauthorized'
        '404':
          $ref: '#/components/responses/not_found'
        '429':
          $ref: '#/components/responses/too_many_requests'
        '500':
          $ref: '#/components/responses/server_error'
        default:
          $ref: '#/components/responses/unexpected_error'
      x-codeSamples:
        - lang: cURL
          source: |-
            curl -X GET \
              -H "Content-Type: text/csv" \
              -H "Authorization: Bearer $DIGITALOCEAN_TOKEN" \
              "https://api.digitalocean.com/v2/customers/my/invoices/22737513-0ea7-4206-8ceb-98a575af7681/csv" --output invoice.csv
        - lang: Python
          source: |-
            import os
            from pydo import Client

            client = Client(token=os.environ.get("DIGITALOCEAN_TOKEN"))

            invoices = client.invoices.get_csv_by_uuid(invoice_uuid=1)
      security:
        - bearer_auth:
            - billing:read
  /v2/customers/my/invoices/{invoice_uuid}/pdf:
    get:
      operationId: invoices_get_pdfByUUID
      summary: Retrieve an Invoice PDF by UUID
      description: >-
        To retrieve a PDF for an invoice, send a GET request to
        `/v2/customers/my/invoices/$INVOICE_UUID/pdf`.
      tags:
        - Billing
      parameters:
        - $ref: '#/components/parameters/invoice_uuid'
      responses:
        '200':
          $ref: '#/components/responses/invoice_pdf'
        '401':
          $ref: '#/components/responses/unauthorized'
        '404':
          $ref: '#/components/responses/not_found'
        '429':
          $ref: '#/components/responses/too_many_requests'
        '500':
          $ref: '#/components/responses/server_error'
        default:
          $ref: '#/components/responses/unexpected_error'
      x-codeSamples:
        - lang: cURL
          source: |-
            curl -X GET \
              -H "Content-Type: application/pdf" \
              -H "Authorization: Bearer $DIGITALOCEAN_TOKEN" \
              "https://api.digitalocean.com/v2/customers/my/invoices/22737513-0ea7-4206-8ceb-98a575af7681/pdf" --output invoice.pdf
        - lang: Python
          source: |-
            import os
            from pydo import Client

            client = Client(token=os.environ.get("DIGITALOCEAN_TOKEN"))

            invoices = client.invoices.get_pdf_by_uuid(invoice_uuid=1)
      security:
        - bearer_auth:
            - billing:read
  /v2/customers/my/invoices/{invoice_uuid}/summary:
    get:
      operationId: invoices_get_summaryByUUID
      summary: Retrieve an Invoice Summary by UUID
      description: >-
        To retrieve a summary for an invoice, send a GET request to
        `/v2/customers/my/invoices/$INVOICE_UUID/summary`.
      tags:
        - Billing
      parameters:
        - $ref: '#/components/parameters/invoice_uuid'
      responses:
        '200':
          $ref: '#/components/responses/invoice_summary'
        '401':
          $ref: '#/components/responses/unauthorized'
        '404':
          $ref: '#/components/responses/not_found'
        '429':
          $ref: '#/components/responses/too_many_requests'
        '500':
          $ref: '#/components/responses/server_error'
        default:
          $ref: '#/components/responses/unexpected_error'
      x-codeSamples:
        - lang: cURL
          source: |-
            curl -X GET \
              -H "Content-Type: application/json" \
              -H "Authorization: Bearer $DIGITALOCEAN_TOKEN" \
              "https://api.digitalocean.com/v2/customers/my/invoices/22737513-0ea7-4206-8ceb-98a575af7681/summary"
        - lang: Python
          source: |-
            import os
            from pydo import Client

            client = Client(token=os.environ.get("DIGITALOCEAN_TOKEN"))

            invoice = client.invoices.get_summary_by_uuid(invoice_uuid="1")
      security:
        - bearer_auth:
            - billing:read
components:
  schemas:
    balance:
      type: object
      properties:
        month_to_date_balance:
          type: string
          description: >-
            Balance as of the `generated_at` time.  This value includes the
            `account_balance` and `month_to_date_usage`.
          example: '23.44'
        account_balance:
          type: string
          description: >-
            Current balance of the customer's most recent billing activity. 
            Does not reflect `month_to_date_usage`.
          example: '12.23'
        month_to_date_usage:
          type: string
          description: >-
            Amount used in the current billing period as of the `generated_at`
            time.
          example: '11.21'
        generated_at:
          type: string
          format: date-time
          description: The time at which balances were most recently generated.
          example: '2019-07-09T15:01:12Z'
    error:
      type: object
      properties:
        id:
          description: >-
            A short identifier corresponding to the HTTP status code returned.
            For  example, the ID for a response returning a 404 status code
            would be "not_found."
          type: string
          example: not_found
        message:
          description: >-
            A message providing additional information about the error,
            including  details to help resolve it when possible.
          type: string
          example: The resource you were accessing could not be found.
        request_id:
          description: >-
            Optionally, some endpoints may include a request ID that should be 
            provided when reporting bugs or opening support tickets to help 
            identify the issue.
          type: string
          example: 4d9d8375-3c56-4925-a3e7-eb137fed17e9
      required:
        - id
        - message
    billing_history:
      type: object
      properties:
        description:
          type: string
          description: Description of the billing history entry.
          example: Invoice for May 2018
        amount:
          type: string
          description: Amount of the billing history entry.
          example: '12.34'
        invoice_id:
          type: string
          description: >-
            ID of the invoice associated with the billing history entry, if 
            applicable.
          example: '123'
        invoice_uuid:
          type: string
          description: >-
            UUID of the invoice associated with the billing history entry, if 
            applicable.
          example: example-uuid
        date:
          type: string
          format: date-time
          description: Time the billing history entry occurred.
          example: '2018-06-01T08:44:38Z'
        type:
          type: string
          description: Type of billing history entry.
          example: Invoice
          enum:
            - ACHFailure
            - Adjustment
            - AttemptFailed
            - Chargeback
            - Credit
            - CreditExpiration
            - Invoice
            - Payment
            - Refund
            - Reversal
    pagination:
      type: object
      properties:
        links:
          $ref: '#/components/schemas/page_links'
    meta_optional_total:
      type: object
      properties:
        meta:
          $ref: '#/components/schemas/meta_properties'
      required:
        - meta
    invoice_preview:
      type: object
      description: The invoice preview.
      properties:
        invoice_uuid:
          type: string
          description: The UUID of the invoice. The canonical reference for the invoice.
          example: fdabb512-6faf-443c-ba2e-665452332a9e
        invoice_id:
          type: string
          description: >-
            ID of the invoice. Listed on the face of the invoice PDF as the
            "Invoice number".
          example: '123456789'
        amount:
          type: string
          description: >-
            Total amount of the invoice, in USD.  This will reflect
            month-to-date usage in the invoice preview.
          example: '23.45'
        invoice_period:
          type: string
          description: >-
            Billing period of usage for which the invoice is issued, in
            `YYYY-MM`  format.
          example: 2020-01
        updated_at:
          type: string
          description: >-
            Time the invoice was last updated.  This is only included with the
            invoice preview.
          example: '2020-01-23T06:31:50Z'
    meta:
      type: object
      properties:
        meta:
          allOf:
            - $ref: '#/components/schemas/meta_properties'
            - required:
                - total
      required:
        - meta
    invoice_item:
      type: object
      properties:
        product:
          type: string
          description: Name of the product being billed in the invoice item.
          example: Kubernetes Clusters
        resource_uuid:
          type: string
          description: UUID of the resource billing in the invoice item if available.
          example: 711157cb-37c8-4817-b371-44fa3504a39c
        resource_id:
          type: string
          description: ID of the resource billing in the invoice item if available.
          example: '2353624'
        group_description:
          type: string
          description: >-
            Description of the invoice item when it is a grouped set of usage,
            such  as DOKS or databases.
          example: my-doks-cluster
        description:
          type: string
          description: Description of the invoice item.
          example: a56e086a317d8410c8b4cfd1f4dc9f82
        amount:
          type: string
          description: Billed amount of this invoice item. Billed in USD.
          example: '12.34'
        duration:
          type: string
          description: Duration of time this invoice item was used and subsequently billed.
          example: '744'
        duration_unit:
          type: string
          description: Unit of time for duration.
          example: Hours
        start_time:
          type: string
          description: Time the invoice item began to be billed for usage.
          example: '2020-01-01T00:00:00Z'
        end_time:
          type: string
          description: Time the invoice item stopped being billed for usage.
          example: '2020-02-01T00:00:00Z'
        project_name:
          type: string
          description: Name of the DigitalOcean Project this resource belongs to.
          example: web
    invoice_summary:
      type: object
      properties:
        invoice_uuid:
          type: string
          description: UUID of the invoice
          example: 22737513-0ea7-4206-8ceb-98a575af7681
        invoice_id:
          type: string
          description: ID of the invoice
          example: '123456789'
        billing_period:
          type: string
          description: >-
            Billing period of usage for which the invoice is issued, in
            `YYYY-MM`  format.
          example: 2020-01
        amount:
          type: string
          description: >-
            Total amount of the invoice, in USD.  This will reflect
            month-to-date usage in the invoice preview.
          example: '27.13'
        user_name:
          type: string
          description: Name of the DigitalOcean customer being invoiced.
          example: Sammy Shark
        user_billing_address:
          allOf:
            - description: The billing address of the customer being invoiced.
            - $ref: '#/components/schemas/billing_address'
        user_company:
          type: string
          description: Company of the DigitalOcean customer being invoiced, if set.
          example: DigitalOcean
        user_email:
          type: string
          description: Email of the DigitalOcean customer being invoiced.
          example: sammy@digitalocean.com
        product_charges:
          allOf:
            - description: >-
                A summary of the product usage charges contributing to the
                invoice.  This will include an amount, and grouped aggregates by
                resource type  under the `items` key.
            - $ref: '#/components/schemas/product_usage_charges'
        overages:
          allOf:
            - description: A summary of the overages contributing to the invoice.
            - $ref: '#/components/schemas/simple_charge'
        taxes:
          allOf:
            - description: A summary of the taxes contributing to the invoice.
            - $ref: '#/components/schemas/simple_charge'
        credits_and_adjustments:
          allOf:
            - description: >-
                A summary of the credits and adjustments contributing to the
                invoice.
            - $ref: '#/components/schemas/simple_charge'
    page_links:
      type: object
      properties:
        pages:
          anyOf:
            - $ref: '#/components/schemas/forward_links'
            - $ref: '#/components/schemas/backward_links'
            - {}
          example:
            pages:
              first: https://api.digitalocean.com/v2/account/keys?page=1
              prev: https://api.digitalocean.com/v2/account/keys?page=2
    meta_properties:
      type: object
      description: Information about the response itself.
      properties:
        total:
          description: Number of objects returned by the request.
          type: integer
          example: 1
    billing_address:
      type: object
      properties:
        address_line1:
          type: string
          description: Street address line 1
          example: 101 Shark Row
        address_line2:
          type: string
          description: Street address line 2
          example: ' '
        city:
          type: string
          description: City
          example: Atlantis
        region:
          type: string
          description: Region
          example: OC
        postal_code:
          type: string
          description: Postal code
          example: '12345'
        country_iso2_code:
          type: string
          description: Country (ISO2) code
          example: US
        created_at:
          type: string
          description: Timestamp billing address was created
          example: '2019-09-03T16:34:46.000+00:00'
        updated_at:
          type: string
          description: Timestamp billing address was updated
          example: '2019-09-03T16:34:46.000+00:00'
    product_usage_charges:
      type: object
      properties:
        name:
          type: string
          description: Description of usage charges
          example: Product usage charges
        amount:
          type: string
          description: Total amount charged
          example: '12.34'
        items:
          type: array
          description: List of amount, and grouped aggregates by resource type.
          items:
            $ref: '#/components/schemas/product_charge_item'
          example:
            - amount: '10.00'
              name: Spaces Subscription
              count: '1'
            - amount: '2.34'
              name: Database Clusters
              count: '1'
    simple_charge:
      type: object
      properties:
        name:
          type: string
          description: Name of the charge
          example: Overages
        amount:
          type: string
          description: Total amount charged in USD
          example: '3.45'
    forward_links:
      allOf:
        - $ref: '#/components/schemas/link_to_last_page'
        - $ref: '#/components/schemas/link_to_next_page'
    backward_links:
      allOf:
        - $ref: '#/components/schemas/link_to_first_page'
        - $ref: '#/components/schemas/link_to_prev_page'
    product_charge_item:
      type: object
      properties:
        amount:
          type: string
          description: Amount of the charge
          example: '10.00'
        name:
          type: string
          description: Description of the charge
          example: Spaces Subscription
        count:
          type: string
          description: Number of times the charge was applied
          example: '1'
    link_to_last_page:
      type: object
      properties:
        last:
          description: URI of the last page of the results.
          type: string
          example: https://api.digitalocean.com/v2/images?page=2
    link_to_next_page:
      type: object
      properties:
        next:
          description: URI of the next page of the results.
          type: string
          example: https://api.digitalocean.com/v2/images?page=2
    link_to_first_page:
      type: object
      properties:
        first:
          description: URI of the first page of the results.
          type: string
          example: https://api.digitalocean.com/v2/images?page=1
    link_to_prev_page:
      type: object
      properties:
        prev:
          description: URI of the previous page of the results.
          type: string
          example: https://api.digitalocean.com/v2/images?page=1
  responses:
    balance:
      description: >-
        The response will be a JSON object that contains the following
        attributes
      headers:
        ratelimit-limit:
          $ref: '#/components/headers/ratelimit-limit'
        ratelimit-remaining:
          $ref: '#/components/headers/ratelimit-remaining'
        ratelimit-reset:
          $ref: '#/components/headers/ratelimit-reset'
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/balance'
          example:
            month_to_date_balance: '23.44'
            account_balance: '12.23'
            month_to_date_usage: '11.21'
            generated_at: '2019-07-09T15:01:12Z'
    unauthorized:
      description: Authentication failed due to invalid credentials.
      headers:
        ratelimit-limit:
          $ref: '#/components/headers/ratelimit-limit'
        ratelimit-remaining:
          $ref: '#/components/headers/ratelimit-remaining'
        ratelimit-reset:
          $ref: '#/components/headers/ratelimit-reset'
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/error'
          example:
            id: unauthorized
            message: Unable to authenticate you.
    not_found:
      description: The resource was not found.
      headers:
        ratelimit-limit:
          $ref: '#/components/headers/ratelimit-limit'
        ratelimit-remaining:
          $ref: '#/components/headers/ratelimit-remaining'
        ratelimit-reset:
          $ref: '#/components/headers/ratelimit-reset'
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/error'
          example:
            id: not_found
            message: The resource you requested could not be found.
    too_many_requests:
      description: The API rate limit has been exceeded.
      headers:
        ratelimit-limit:
          $ref: '#/components/headers/ratelimit-limit'
        ratelimit-remaining:
          $ref: '#/components/headers/ratelimit-remaining'
        ratelimit-reset:
          $ref: '#/components/headers/ratelimit-reset'
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/error'
          example:
            id: too_many_requests
            message: API rate limit exceeded.
    server_error:
      description: There was a server error.
      headers:
        ratelimit-limit:
          $ref: '#/components/headers/ratelimit-limit'
        ratelimit-remaining:
          $ref: '#/components/headers/ratelimit-remaining'
        ratelimit-reset:
          $ref: '#/components/headers/ratelimit-reset'
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/error'
          example:
            id: server_error
            message: Unexpected server-side error
    unexpected_error:
      description: There was an unexpected error.
      headers:
        ratelimit-limit:
          $ref: '#/components/headers/ratelimit-limit'
        ratelimit-remaining:
          $ref: '#/components/headers/ratelimit-remaining'
        ratelimit-reset:
          $ref: '#/components/headers/ratelimit-reset'
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/error'
          example:
            id: example_error
            message: some error message
    billing_history:
      description: >-
        The response will be a JSON object that contains the following
        attributes
      headers:
        ratelimit-limit:
          $ref: '#/components/headers/ratelimit-limit'
        ratelimit-remaining:
          $ref: '#/components/headers/ratelimit-remaining'
        ratelimit-reset:
          $ref: '#/components/headers/ratelimit-reset'
      content:
        application/json:
          schema:
            allOf:
              - type: object
                properties:
                  billing_history:
                    type: array
                    items:
                      $ref: '#/components/schemas/billing_history'
              - $ref: '#/components/schemas/pagination'
              - $ref: '#/components/schemas/meta_optional_total'
            example:
              billing_history:
                - description: Invoice for May 2018
                  amount: '12.34'
                  invoice_id: '123'
                  invoice_uuid: example-uuid
                  date: '2018-06-01T08:44:38Z'
                  type: Invoice
                - description: Payment (MC 2018)
                  amount: '-12.34'
                  date: '2018-06-02T08:44:38Z'
                  type: Payment
              links:
                pages:
                  next: >-
                    https://api.digitalocean.com/v2/customers/my/billing_history?page=2&per_page=2
                  last: >-
                    https://api.digitalocean.com/v2/customers/my/billing_history?page=3&per_page=2
              meta:
                total: 5
    invoices:
      description: >-
        The response will be a JSON object contains that contains a list of
        invoices under the `invoices` key, and the invoice preview under the
        `invoice_preview` key.

        Each element contains the invoice summary attributes.
      headers:
        ratelimit-limit:
          $ref: '#/components/headers/ratelimit-limit'
        ratelimit-remaining:
          $ref: '#/components/headers/ratelimit-remaining'
        ratelimit-reset:
          $ref: '#/components/headers/ratelimit-reset'
      content:
        application/json:
          schema:
            allOf:
              - type: object
                properties:
                  invoices:
                    type: array
                    items:
                      $ref: '#/components/schemas/invoice_preview'
                  invoice_preview:
                    $ref: '#/components/schemas/invoice_preview'
              - $ref: '#/components/schemas/pagination'
              - $ref: '#/components/schemas/meta'
            example:
              invoices:
                - invoice_uuid: 22737513-0ea7-4206-8ceb-98a575af7681
                  invoice_id: '12345678'
                  amount: '12.34'
                  invoice_period: 2019-12
                - invoice_uuid: fdabb512-6faf-443c-ba2e-665452332a9e
                  invoice_id: '23456789'
                  amount: '23.45'
                  invoice_period: 2019-11
              invoice_preview:
                invoice_uuid: 1afe95e6-0958-4eb0-8d9a-9c5060d3ef03
                invoice_id: '34567890'
                amount: '34.56'
                invoice_period: 2020-02
                updated_at: '2020-02-23T06:31:50Z'
              links:
                pages:
                  next: >-
                    https://api.digitalocean.com/v2/customers/my/invoices?page=2&per_page=2
                  last: >-
                    https://api.digitalocean.com/v2/customers/my/invoices?page=35&per_page=2
              meta:
                total: 70
    invoice:
      description: >-
        The response will be a JSON object with a key called `invoice_items`.
        This will be set to an array of invoice item objects. All resources will
        be shown on invoices, regardless of permissions.
      headers:
        ratelimit-limit:
          $ref: '#/components/headers/ratelimit-limit'
        ratelimit-remaining:
          $ref: '#/components/headers/ratelimit-remaining'
        ratelimit-reset:
          $ref: '#/components/headers/ratelimit-reset'
      content:
        application/json:
          schema:
            allOf:
              - type: object
                properties:
                  invoice_items:
                    type: array
                    items:
                      $ref: '#/components/schemas/invoice_item'
              - $ref: '#/components/schemas/pagination'
              - $ref: '#/components/schemas/meta'
            example:
              invoice_items:
                - product: Kubernetes Clusters
                  resource_uuid: 711157cb-37c8-4817-b371-44fa3504a39c
                  group_description: my-doks-cluster
                  description: a56e086a317d8410c8b4cfd1f4dc9f82
                  amount: '12.34'
                  duration: '744'
                  duration_unit: Hours
                  start_time: '2020-01-01T00:00:00Z'
                  end_time: '2020-02-01T00:00:00Z'
                - product: Spaces Subscription
                  description: Spaces ($5/mo 250GB storage & 1TB bandwidth)
                  amount: '34.45'
                  duration: '744'
                  duration_unit: Hours
                  start_time: '2020-01-01T00:00:00Z'
                  end_time: '2020-02-01T00:00:00Z'
              links:
                pages:
                  next: >-
                    https://api.digitalocean.com/v2/customers/my/invoices/22737513-0ea7-4206-8ceb-98a575af7681?page=2&per_page=2
                  last: >-
                    https://api.digitalocean.com/v2/customers/my/invoices/22737513-0ea7-4206-8ceb-98a575af7681?page=3&per_page=2
              meta:
                total: 6
    invoice_csv:
      description: The response will be a CSV file.
      headers:
        content-disposition:
          $ref: '#/components/headers/content-disposition'
        ratelimit-limit:
          $ref: '#/components/headers/ratelimit-limit'
        ratelimit-remaining:
          $ref: '#/components/headers/ratelimit-remaining'
        ratelimit-reset:
          $ref: '#/components/headers/ratelimit-reset'
      content:
        text/csv:
          schema:
            type: string
          example: >
            product,group_description,description,hours,start,end,USD,project_name,category

            Floating IPs,,Unused Floating IP - 1.1.1.1,100,2020-07-01 00:00:00
            +0000,2020-07-22 18:14:39 +0000,$3.11,,iaas

            Taxes,,STATE SALES TAX (6.25%),,2020-07-01 00:00:00 +0000,2020-07-31
            23:59:59 +0000,$0.16,,iaas
    invoice_pdf:
      description: The response will be a PDF file.
      headers:
        content-disposition:
          $ref: '#/components/headers/content-disposition'
        ratelimit-limit:
          $ref: '#/components/headers/ratelimit-limit'
        ratelimit-remaining:
          $ref: '#/components/headers/ratelimit-remaining'
        ratelimit-reset:
          $ref: '#/components/headers/ratelimit-reset'
      content:
        application/pdf:
          schema:
            type: string
            format: binary
    invoice_summary:
      description: >-
        To retrieve a summary for an invoice, send a GET request to 
        `/v2/customers/my/invoices/$INVOICE_UUID/summary`.
      headers:
        ratelimit-limit:
          $ref: '#/components/headers/ratelimit-limit'
        ratelimit-remaining:
          $ref: '#/components/headers/ratelimit-remaining'
        ratelimit-reset:
          $ref: '#/components/headers/ratelimit-reset'
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/invoice_summary'
          example:
            invoice_uuid: 22737513-0ea7-4206-8ceb-98a575af7681
            invoice_id: '123456789'
            billing_period: 2020-01
            amount: '27.13'
            user_name: Sammy Shark
            user_billing_address:
              address_line1: 101 Shark Row
              city: Atlantis
              region: OC
              postal_code: '12345'
              country_iso2_code: US
              created_at: '2019-09-03T16:34:46.000+00:00'
              updated_at: '2019-09-03T16:34:46.000+00:00'
            user_company: DigitalOcean
            user_email: sammy@digitalocean.com
            product_charges:
              name: Product usage charges
              amount: '12.34'
              items:
                - amount: '10.00'
                  name: Spaces Subscription
                  count: '1'
                - amount: '2.34'
                  name: Database Clusters
                  count: '1'
            overages:
              name: Overages
              amount: '3.45'
            taxes:
              name: Taxes
              amount: '4.56'
            credits_and_adjustments:
              name: Credits & adjustments
              amount: '6.78'
  parameters:
    per_page:
      in: query
      name: per_page
      required: false
      description: Number of items returned per page
      schema:
        type: integer
        minimum: 1
        default: 20
        maximum: 200
      example: 2
    page:
      in: query
      name: page
      required: false
      description: Which 'page' of paginated results to return.
      schema:
        type: integer
        minimum: 1
        default: 1
      example: 1
    invoice_uuid:
      name: invoice_uuid
      description: UUID of the invoice
      in: path
      schema:
        type: string
      example: 22737513-0ea7-4206-8ceb-98a575af7681
      required: true
  headers:
    ratelimit-limit:
      schema:
        type: integer
      example: 5000
      description: >-
        The default limit on number of requests that can be made per hour and
        per minute. Current rate limits are 5000 requests per hour and 250
        requests per minute.
    ratelimit-remaining:
      schema:
        type: integer
      example: 4816
      description: >-
        The number of requests in your hourly quota that remain before you hit
        your request limit. See
        https://developers.digitalocean.com/documentation/v2/#rate-limit for
        information about how requests expire.
    ratelimit-reset:
      schema:
        type: integer
      example: 1444931833
      description: >-
        The time when the oldest request will expire. The value is given in Unix
        epoch time. See
        https://developers.digitalocean.com/documentation/v2/#rate-limit for
        information about how requests expire.
    content-disposition:
      description: >-
        Indicates if the content is expected to be displayed *inline* in the 
        browser, that is, as a Web page or as part of a Web page, or as an 
        *attachment*, that is downloaded and saved locally.
      schema:
        type: string
      example: >-
        attachment; filename="DigitalOcean Invoice 2020 Jul
        (6173678-418071234).csv"
  x-stackQL-resources:
    balances:
      id: digitalocean.billing.balances
      name: balances
      title: Balances
      methods:
        balance_get:
          operation:
            $ref: '#/paths/~1v2~1customers~1my~1balance/get'
          response:
            mediaType: application/json
            openAPIDocKey: '200'
      sqlVerbs:
        select:
          - $ref: '#/components/x-stackQL-resources/balances/methods/balance_get'
        insert: []
        update: []
        delete: []
        replace: []
    billing_history:
      id: digitalocean.billing.billing_history
      name: billing_history
      title: Billing History
      methods:
        billing_history_list:
          operation:
            $ref: '#/paths/~1v2~1customers~1my~1billing_history/get'
          response:
            mediaType: application/json
            openAPIDocKey: '200'
            objectKey: $.billing_history
      sqlVerbs:
        select:
          - $ref: >-
              #/components/x-stackQL-resources/billing_history/methods/billing_history_list
        insert: []
        update: []
        delete: []
        replace: []
    invoices:
      id: digitalocean.billing.invoices
      name: invoices
      title: Invoices
      methods:
        invoices_list:
          operation:
            $ref: '#/paths/~1v2~1customers~1my~1invoices/get'
          response:
            mediaType: application/json
            openAPIDocKey: '200'
        invoices_get_by_uuid:
          operation:
            $ref: '#/paths/~1v2~1customers~1my~1invoices~1{invoice_uuid}/get'
          response:
            mediaType: application/json
            openAPIDocKey: '200'
            objectKey: $.invoice_items
        invoices_get_csv_by_uuid:
          operation:
            $ref: '#/paths/~1v2~1customers~1my~1invoices~1{invoice_uuid}~1csv/get'
          response:
            mediaType: application/json
            openAPIDocKey: '200'
        invoices_get_pdf_by_uuid:
          operation:
            $ref: '#/paths/~1v2~1customers~1my~1invoices~1{invoice_uuid}~1pdf/get'
          response:
            mediaType: application/json
            openAPIDocKey: '200'
      sqlVerbs:
        select:
          - $ref: >-
              #/components/x-stackQL-resources/invoices/methods/invoices_get_by_uuid
          - $ref: '#/components/x-stackQL-resources/invoices/methods/invoices_list'
        insert: []
        update: []
        delete: []
        replace: []
    invoice_summary:
      id: digitalocean.billing.invoice_summary
      name: invoice_summary
      title: Invoice Summary
      methods:
        invoices_get_summary_by_uuid:
          operation:
            $ref: '#/paths/~1v2~1customers~1my~1invoices~1{invoice_uuid}~1summary/get'
          response:
            mediaType: application/json
            openAPIDocKey: '200'
      sqlVerbs:
        select:
          - $ref: >-
              #/components/x-stackQL-resources/invoice_summary/methods/invoices_get_summary_by_uuid
        insert: []
        update: []
        delete: []
        replace: []
servers:
  - url: https://api.digitalocean.com
